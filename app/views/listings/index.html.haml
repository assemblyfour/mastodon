.compact-header
  %h1 Switter Listings

%p
  Search #{ListingSearchService.listings.count} active Switter listings.
= form_tag '/', method: 'GET', class: 'simple_form' do
  .fields-group
    .input.string.required
      = text_field_tag 'query', params[:query], class: 'string required', placeholder: 'Enter search terms. For example: Melbourne'

    .actions
      %button Search
      = link_to 'Post a listing', %Q|https://switter.at/share?text=#{URI.encode(@placeholder)}|, class: 'button'

    .flash-message
      %p Listings last for 30 days.
      %p Listings are a work in progress. Don't abuse this feature (don't post more than twice a day) otherwise your account will be suspended.


- @listings.each do |listing|
  - stream_entry = listing.stream_entry
  - type         = stream_entry.activity_type.downcase
  .activity-stream.activity-stream-headless.h-entry
    .entry
      = render partial: "stream_entries/simple_status", locals: { status: listing, include_threads: false }
  %br

- if @listings.empty?
  .flash-message= "Sorry, your search for '#{params[:query]}' has no results. Try a different search term."

%br
%br
%br

= form_tag '/', method: 'GET', class: 'simple_form' do
  .fields-group
    .input.string.required
      = text_field_tag 'query', params[:query], class: 'string required', placeholder: 'Enter search terms. For example: Melbourne'

    .actions
      %button Search
      = link_to 'Post a listing', %Q|https://switter.at/share?text=#{URI.encode(@placeholder)}|, class: 'button'
